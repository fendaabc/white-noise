# Design Document

## Overview

ç™½å™ªéŸ³ç½‘ç«™æ˜¯ä¸€ä¸ªåŸºäºWeb Audio APIçš„å•é¡µé¢åº”ç”¨ç¨‹åºï¼Œæä¾›æ²‰æµ¸å¼çš„ç¯å¢ƒéŸ³æ•ˆæ’­æ”¾ä½“éªŒã€‚ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–æ¶æ„ï¼Œå°†éŸ³é¢‘ç®¡ç†ã€å®šæ—¶å™¨æ§åˆ¶å’Œç”¨æˆ·ç•Œé¢åˆ†ç¦»ï¼Œç¡®ä¿ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚

## Architecture

### ç³»ç»Ÿæ¶æ„å›¾

```mermaid
graph TB
    A[index.html] --> B[main.js]
    B --> C[AudioManager.js]
    B --> D[TimerManager.js]
    B --> E[style.css]
    
    C --> F[Web Audio API]
    C --> G[Audio Files]
    
    H[User Interface] --> B
    B --> H
    
    subgraph "Core Modules"
        C
        D
    end
    
    subgraph "External Resources"
        F
        G
    end
```

### æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: åŸç”ŸJavaScript (ES6+)
- **éŸ³é¢‘å¤„ç†**: Web Audio API
- **æ ·å¼**: CSS3 (Flexbox, CSS Grid, CSS Animations)
- **æ„å»ºå·¥å…·**: æ— éœ€æ„å»ºå·¥å…·ï¼Œç›´æ¥è¿è¡Œåœ¨æµè§ˆå™¨ä¸­

## Components and Interfaces

### 1. AudioManager ç±»

**èŒè´£**: ç®¡ç†æ‰€æœ‰éŸ³é¢‘ç›¸å…³æ“ä½œï¼ŒåŒ…æ‹¬åŠ è½½ã€æ’­æ”¾ã€åœæ­¢å’ŒéŸ³é‡æ§åˆ¶

**æ¥å£è®¾è®¡**:
```javascript
class AudioManager {
    constructor()
    async loadSounds(soundList)
    playSound(name)
    stopSound(name)
    setVolume(name, volume)
    stopAllSounds()
    getCurrentlyPlaying()
}
```

**æ ¸å¿ƒå±æ€§**:
- `audioContext`: AudioContextå®ä¾‹
- `soundBuffers`: å­˜å‚¨è§£ç åçš„éŸ³é¢‘æ•°æ®
- `activeSources`: è·Ÿè¸ªå½“å‰æ’­æ”¾çš„éŸ³æº
- `gainNodes`: å­˜å‚¨æ¯ä¸ªéŸ³æºçš„éŸ³é‡æ§åˆ¶èŠ‚ç‚¹

### 2. TimerManager ç±»

**èŒè´£**: ç®¡ç†å®šæ—¶å™¨åŠŸèƒ½ï¼Œæ”¯æŒè®¾ç½®å’Œå–æ¶ˆå®šæ—¶ä»»åŠ¡

**æ¥å£è®¾è®¡**:
```javascript
class TimerManager {
    constructor()
    start(minutes, callback)
    cancel()
    getRemainingTime()
    isActive()
}
```

**æ ¸å¿ƒå±æ€§**:
- `activeTimer`: å½“å‰æ´»åŠ¨çš„å®šæ—¶å™¨ID
- `startTime`: å®šæ—¶å™¨å¼€å§‹æ—¶é—´
- `duration`: å®šæ—¶å™¨æŒç»­æ—¶é—´

### 3. UI Controller (main.js)

**èŒè´£**: åè°ƒç”¨æˆ·ç•Œé¢å’Œæ ¸å¿ƒæ¨¡å—ä¹‹é—´çš„äº¤äº’

**æ ¸å¿ƒåŠŸèƒ½**:
- åˆå§‹åŒ–æ‰€æœ‰æ¨¡å—
- ç»‘å®šDOMäº‹ä»¶ç›‘å¬å™¨
- ç®¡ç†UIçŠ¶æ€æ›´æ–°
- å¤„ç†ç”¨æˆ·äº¤äº’é€»è¾‘

## Data Models

### éŸ³é¢‘é…ç½®æ¨¡å‹

```javascript
const soundConfig = {
    rain: {
        path: 'audio/rain.mp3',
        name: 'é›¨å£°',
        icon: 'ğŸŒ§ï¸'
    },
    waves: {
        path: 'audio/waves.mp3',
        name: 'æµ·æµªå£°',
        icon: 'ğŸŒŠ'
    },
    fire: {
        path: 'audio/fire.mp3',
        name: 'ç¯ç«å£°',
        icon: 'ğŸ”¥'
    },
    forest: {
        path: 'audio/forest.mp3',
        name: 'æ£®æ—å£°',
        icon: 'ğŸŒ²'
    },
    cafe: {
        path: 'audio/cafe.mp3',
        name: 'å’–å•¡å…',
        icon: 'â˜•'
    }
};
```

### åº”ç”¨çŠ¶æ€æ¨¡å‹

```javascript
const appState = {
    isPlaying: false,
    currentSound: null,
    volume: 0.7,
    timerActive: false,
    timerDuration: 0
};
```

## Error Handling

### éŸ³é¢‘åŠ è½½é”™è¯¯å¤„ç†

1. **ç½‘ç»œé”™è¯¯**: å½“éŸ³é¢‘æ–‡ä»¶æ— æ³•åŠ è½½æ—¶ï¼Œæ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
2. **æ ¼å¼ä¸æ”¯æŒ**: æ£€æµ‹æµè§ˆå™¨éŸ³é¢‘æ ¼å¼æ”¯æŒï¼Œæä¾›é™çº§æ–¹æ¡ˆ
3. **AudioContexté”™è¯¯**: å¤„ç†æµè§ˆå™¨éŸ³é¢‘ä¸Šä¸‹æ–‡åˆ›å»ºå¤±è´¥çš„æƒ…å†µ

### ç”¨æˆ·äº¤äº’é”™è¯¯å¤„ç†

1. **é‡å¤ç‚¹å‡»ä¿æŠ¤**: é˜²æ­¢ç”¨æˆ·å¿«é€Ÿç‚¹å‡»å¯¼è‡´çš„çŠ¶æ€æ··ä¹±
2. **å®šæ—¶å™¨å†²çª**: ç¡®ä¿åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªå®šæ—¶å™¨æ´»åŠ¨
3. **éŸ³é‡èŒƒå›´éªŒè¯**: ç¡®ä¿éŸ³é‡å€¼åœ¨æœ‰æ•ˆèŒƒå›´å†…

### é”™è¯¯å¤„ç†ç­–ç•¥

```javascript
// é”™è¯¯å¤„ç†ç¤ºä¾‹
try {
    await audioManager.loadSounds(soundConfig);
} catch (error) {
    console.error('éŸ³é¢‘åŠ è½½å¤±è´¥:', error);
    showErrorMessage('éŸ³é¢‘æ–‡ä»¶åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
}
```

## Testing Strategy

### å•å…ƒæµ‹è¯•

1. **AudioManageræµ‹è¯•**:
   - éŸ³é¢‘åŠ è½½åŠŸèƒ½æµ‹è¯•
   - æ’­æ”¾/åœæ­¢åŠŸèƒ½æµ‹è¯•
   - éŸ³é‡æ§åˆ¶æµ‹è¯•
   - é”™è¯¯å¤„ç†æµ‹è¯•

2. **TimerManageræµ‹è¯•**:
   - å®šæ—¶å™¨è®¾ç½®æµ‹è¯•
   - å®šæ—¶å™¨å–æ¶ˆæµ‹è¯•
   - å›è°ƒå‡½æ•°æ‰§è¡Œæµ‹è¯•

### é›†æˆæµ‹è¯•

1. **ç”¨æˆ·äº¤äº’æµç¨‹æµ‹è¯•**:
   - æ’­æ”¾æŒ‰é’®ç‚¹å‡»æµç¨‹
   - éŸ³æ•ˆåˆ‡æ¢æµç¨‹
   - å®šæ—¶å™¨è®¾ç½®æµç¨‹
   - éŸ³é‡è°ƒèŠ‚æµç¨‹

### æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•

1. **ç°ä»£æµè§ˆå™¨æ”¯æŒ**:
   - Chrome 66+
   - Firefox 60+
   - Safari 11.1+
   - Edge 79+

2. **Web Audio APIåŠŸèƒ½æµ‹è¯•**:
   - AudioContextåˆ›å»º
   - éŸ³é¢‘è§£ç åŠŸèƒ½
   - éŸ³é¢‘æ’­æ”¾åŠŸèƒ½

### æ€§èƒ½æµ‹è¯•

1. **éŸ³é¢‘åŠ è½½æ€§èƒ½**:
   - é¦–æ¬¡åŠ è½½æ—¶é—´æµ‹è¯•
   - å†…å­˜ä½¿ç”¨æƒ…å†µç›‘æ§
   - å¤šéŸ³é¢‘åŒæ—¶æ’­æ”¾æ€§èƒ½

2. **UIå“åº”æ€§æµ‹è¯•**:
   - æŒ‰é’®ç‚¹å‡»å“åº”æ—¶é—´
   - éŸ³é‡æ»‘å—å®æ—¶å“åº”
   - åŠ¨ç”»æµç•…åº¦æµ‹è¯•

## UI/UX Design Specifications

### ç°ä»£åŒ–è®¾è®¡åŸåˆ™

1. **ç°ä»£æ‰å¹³åŒ–è®¾è®¡**: å‚è€ƒMaterial Designå’ŒiOSè®¾è®¡è¯­è¨€ï¼Œä½¿ç”¨å¡ç‰‡å¼å¸ƒå±€å’Œå¾®å¦™é˜´å½±
2. **æ²‰æµ¸å¼ä½“éªŒ**: å…¨å±æ¸å˜èƒŒæ™¯æˆ–åŠ¨æ€ç²’å­æ•ˆæœï¼Œè¥é€ ä¸“æ³¨ç¯å¢ƒ
3. **ç§»åŠ¨ä¼˜å…ˆ**: ä¼˜å…ˆè€ƒè™‘ç§»åŠ¨è®¾å¤‡ä½“éªŒï¼Œç„¶åé€‚é…æ¡Œé¢ç«¯
4. **å¯è®¿é—®æ€§**: æ”¯æŒæ·±è‰²æ¨¡å¼ã€é«˜å¯¹æ¯”åº¦å’Œé”®ç›˜å¯¼èˆª
5. **å¾®äº¤äº’**: ä¸°å¯Œçš„åŠ¨ç”»åé¦ˆå’ŒçŠ¶æ€æŒ‡ç¤º

### ç°ä»£åŒ–è‰²å½©æ–¹æ¡ˆ

```css
:root {
    /* ä¸»è‰²è°ƒ - ç°ä»£æ¸å˜è‰² */
    --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    
    /* éŸ³æ•ˆä¸»é¢˜è‰² */
    --rain-color: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
    --waves-color: linear-gradient(135deg, #00cec9 0%, #00b894 100%);
    --fire-color: linear-gradient(135deg, #fd79a8 0%, #e84393 100%);
    --forest-color: linear-gradient(135deg, #00b894 0%, #00a085 100%);
    --cafe-color: linear-gradient(135deg, #fdcb6e 0%, #e17055 100%);
    
    /* åŸºç¡€è‰²å½© */
    --text-primary: #2d3436;
    --text-secondary: #636e72;
    --text-light: #b2bec3;
    --background-light: #ffffff;
    --background-dark: #2d3436;
    --surface-light: rgba(255, 255, 255, 0.9);
    --surface-dark: rgba(45, 52, 54, 0.9);
    
    /* åŠŸèƒ½è‰²å½© */
    --success-color: #00b894;
    --warning-color: #fdcb6e;
    --error-color: #e17055;
    --info-color: #74b9ff;
    
    /* é˜´å½±å’Œæ•ˆæœ */
    --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.1);
    --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.15);
    --shadow-heavy: 0 15px 50px rgba(0, 0, 0, 0.2);
    --blur-effect: blur(20px);
    
    /* åŠ¨ç”»å‚æ•° */
    --transition-fast: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-normal: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* æ·±è‰²æ¨¡å¼ */
@media (prefers-color-scheme: dark) {
    :root {
        --text-primary: #ddd;
        --text-secondary: #b2bec3;
        --background-light: #2d3436;
        --surface-light: rgba(45, 52, 54, 0.9);
    }
}
```

### ç°ä»£åŒ–å¸ƒå±€è§„èŒƒ

#### 1. ä¸»æ’­æ”¾æŒ‰é’®è®¾è®¡
- **å°ºå¯¸**: ç§»åŠ¨ç«¯100pxï¼Œæ¡Œé¢ç«¯120pxçš„åœ†å½¢æŒ‰é’®
- **å›¾æ ‡**: ä½¿ç”¨SVGæ’­æ”¾/æš‚åœå›¾æ ‡ï¼Œè€Œéæ–‡å­—
- **æ•ˆæœ**: æ¯›ç»ç’ƒèƒŒæ™¯ã€åŠ¨æ€é˜´å½±ã€æŒ‰å‹åŠ¨ç”»
- **çŠ¶æ€**: æ’­æ”¾æ—¶æ˜¾ç¤ºéŸ³é¢‘æ³¢å½¢åŠ¨ç”»

#### 2. éŸ³æ•ˆé€‰æ‹©å™¨ç°ä»£åŒ–è®¾è®¡
- **å¸ƒå±€**: å“åº”å¼ç½‘æ ¼ï¼Œç§»åŠ¨ç«¯3åˆ—ï¼Œæ¡Œé¢ç«¯5åˆ—
- **æŒ‰é’®**: å¤§å°ºå¯¸åœ†å½¢æŒ‰é’®ï¼ˆ80px-100pxï¼‰
- **å›¾æ ‡**: é«˜è´¨é‡SVGå›¾æ ‡æˆ–emojiï¼Œé…åˆæ¸å˜èƒŒæ™¯
- **çŠ¶æ€**: æ¿€æ´»æ—¶æ˜¾ç¤ºå‘¼å¸åŠ¨ç”»æ•ˆæœ
- **é¢„è§ˆ**: é•¿æŒ‰æ˜¾ç¤ºéŸ³æ•ˆæ³¢å½¢é¢„è§ˆ

#### 3. æ§åˆ¶é¢æ¿ç°ä»£åŒ–
- **éŸ³é‡æ§åˆ¶**: ç°ä»£åŒ–æ»‘å—è®¾è®¡ï¼Œå®æ—¶éŸ³é‡å¯è§†åŒ–
- **å®šæ—¶å™¨**: åœ†å½¢è¿›åº¦æ¡è®¾è®¡ï¼Œä¼˜é›…çš„æ—¶é—´é€‰æ‹©å™¨
- **è®¾ç½®é¢æ¿**: å…¨å±æ¨¡æ€æ¡†ï¼Œæ¯›ç»ç’ƒèƒŒæ™¯

### é«˜çº§åŠ¨ç”»æ•ˆæœ

#### 1. é¡µé¢åŠ è½½åŠ¨ç”»
```css
@keyframes pageLoad {
    0% { opacity: 0; transform: translateY(30px); }
    100% { opacity: 1; transform: translateY(0); }
}
```

#### 2. éŸ³æ•ˆæŒ‰é’®å‘¼å¸åŠ¨ç”»
```css
@keyframes breathe {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}
```

#### 3. æ’­æ”¾æŒ‰é’®æ³¢å½¢åŠ¨ç”»
```css
@keyframes waveform {
    0%, 100% { height: 20px; }
    50% { height: 40px; }
}
```

#### 4. èƒŒæ™¯ç²’å­åŠ¨ç”»
```css
@keyframes float {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    33% { transform: translateY(-30px) rotate(120deg); }
    66% { transform: translateY(30px) rotate(240deg); }
}
```

### å“åº”å¼è®¾è®¡è§„èŒƒ

#### ç§»åŠ¨ç«¯ä¼˜åŒ– (320px - 768px)
- **è§¦æ‘¸å‹å¥½**: æœ€å°ç‚¹å‡»åŒºåŸŸ44px
- **æ‰‹åŠ¿æ”¯æŒ**: æ»‘åŠ¨åˆ‡æ¢éŸ³æ•ˆï¼ŒåŒå‡»æ’­æ”¾
- **å…¨å±ä½“éªŒ**: éšè—æµè§ˆå™¨UIï¼Œæ²‰æµ¸å¼ä½“éªŒ
- **æ€§èƒ½ä¼˜åŒ–**: å‡å°‘åŠ¨ç”»å¤æ‚åº¦ï¼Œä¼˜åŒ–æ¸²æŸ“

#### å¹³æ¿ç«¯é€‚é… (768px - 1024px)
- **æ··åˆå¸ƒå±€**: ç»“åˆç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯ç‰¹æ€§
- **æ¨ªå±ä¼˜åŒ–**: æ°´å¹³å¸ƒå±€éŸ³æ•ˆé€‰æ‹©å™¨
- **è§¦æ‘¸+é¼ æ ‡**: åŒæ—¶æ”¯æŒè§¦æ‘¸å’Œé¼ æ ‡æ“ä½œ

#### æ¡Œé¢ç«¯å¢å¼º (1024px+)
- **é”®ç›˜å¿«æ·é”®**: å®Œæ•´çš„é”®ç›˜æ“ä½œæ”¯æŒ
- **é¼ æ ‡æ‚¬åœ**: ä¸°å¯Œçš„æ‚¬åœæ•ˆæœå’Œæç¤º
- **å¤šçª—å£**: æ”¯æŒçª—å£ç¼©æ”¾å’Œå¤šæ˜¾ç¤ºå™¨

### å¯è®¿é—®æ€§è®¾è®¡

#### 1. è§†è§‰å¯è®¿é—®æ€§
- **å¯¹æ¯”åº¦**: ç¬¦åˆWCAG 2.1 AAæ ‡å‡†
- **å­—ä½“å¤§å°**: æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ç¼©æ”¾
- **è‰²å½©**: ä¸ä¾èµ–é¢œè‰²ä¼ è¾¾ä¿¡æ¯

#### 2. æ“ä½œå¯è®¿é—®æ€§
- **é”®ç›˜å¯¼èˆª**: å®Œæ•´çš„Tabé”®å¯¼èˆª
- **å±å¹•é˜…è¯»å™¨**: è¯­ä¹‰åŒ–HTMLå’ŒARIAæ ‡ç­¾
- **ç„¦ç‚¹æŒ‡ç¤º**: æ¸…æ™°çš„ç„¦ç‚¹çŠ¶æ€

#### 3. è®¤çŸ¥å¯è®¿é—®æ€§
- **ç®€æ´ç•Œé¢**: å‡å°‘è®¤çŸ¥è´Ÿæ‹…
- **ä¸€è‡´æ€§**: ç»Ÿä¸€çš„äº¤äº’æ¨¡å¼
- **åé¦ˆ**: åŠæ—¶çš„æ“ä½œåé¦ˆ

### æ€§èƒ½ä¼˜åŒ–è®¾è®¡

#### 1. æ¸²æŸ“ä¼˜åŒ–
- **CSSåŠ¨ç”»**: ä¼˜å…ˆä½¿ç”¨transformå’Œopacity
- **GPUåŠ é€Ÿ**: ä½¿ç”¨will-changeå±æ€§
- **é‡ç»˜æœ€å°åŒ–**: é¿å…é¢‘ç¹çš„å¸ƒå±€å˜åŒ–

#### 2. èµ„æºä¼˜åŒ–
- **å›¾æ ‡**: ä½¿ç”¨SVG spriteæˆ–icon font
- **å›¾ç‰‡**: WebPæ ¼å¼ï¼Œå“åº”å¼å›¾ç‰‡
- **å­—ä½“**: å­—ä½“å­é›†åŒ–ï¼Œé¢„åŠ è½½å…³é”®å­—ä½“

#### 3. äº¤äº’ä¼˜åŒ–
- **é˜²æŠ–èŠ‚æµ**: ä¼˜åŒ–é«˜é¢‘äº‹ä»¶å¤„ç†
- **æ‡’åŠ è½½**: éå…³é”®èµ„æºå»¶è¿ŸåŠ è½½
- **é¢„åŠ è½½**: é¢„æµ‹ç”¨æˆ·è¡Œä¸ºï¼Œæå‰åŠ è½½

## File Structure

```
white-noise-website/
â”œâ”€â”€ index.html              # ä¸»HTMLæ–‡ä»¶
â”œâ”€â”€ css/
â”‚   â””â”€â”€ style.css          # ä¸»æ ·å¼æ–‡ä»¶
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ AudioManager.js    # éŸ³é¢‘ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ TimerManager.js    # å®šæ—¶å™¨ç®¡ç†æ¨¡å—
â”‚   â””â”€â”€ main.js           # ä¸»æ§åˆ¶é€»è¾‘
â””â”€â”€ audio/                # éŸ³é¢‘æ–‡ä»¶ç›®å½•
    â”œâ”€â”€ rain.mp3
    â”œâ”€â”€ waves.mp3
    â”œâ”€â”€ fire.mp3
    â”œâ”€â”€ forest.mp3
    â””â”€â”€ cafe.mp3
```

## Security Considerations

1. **å†…å®¹å®‰å…¨ç­–ç•¥**: å®æ–½CSPé˜²æ­¢XSSæ”»å‡»
2. **éŸ³é¢‘æ–‡ä»¶éªŒè¯**: ç¡®ä¿éŸ³é¢‘æ–‡ä»¶æ¥æºå¯ä¿¡
3. **ç”¨æˆ·è¾“å…¥éªŒè¯**: éªŒè¯å®šæ—¶å™¨è¾“å…¥å€¼çš„åˆæ³•æ€§

## Performance Optimization

1. **éŸ³é¢‘é¢„åŠ è½½**: é¡µé¢åŠ è½½æ—¶é¢„åŠ è½½æ‰€æœ‰éŸ³é¢‘æ–‡ä»¶
2. **å†…å­˜ç®¡ç†**: åŠæ—¶æ¸…ç†ä¸ä½¿ç”¨çš„AudioBufferSourceNode
3. **æ‡’åŠ è½½**: è€ƒè™‘å¯¹å¤§éŸ³é¢‘æ–‡ä»¶å®æ–½æ‡’åŠ è½½ç­–ç•¥
4. **ç¼“å­˜ç­–ç•¥**: åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜å‡å°‘é‡å¤åŠ è½½